<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.trkj.projects.mybatis.dao.XsdocumentShopDao">

    <resultMap type="com.trkj.projects.mybatis.entity.XsdocumentShop" id="XsdocumentShopMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="dlNumber" column="dl_number" jdbcType="VARCHAR"/>
        <result property="branchid" column="branchid" jdbcType="INTEGER"/>
        <result property="customerid" column="customerid" jdbcType="INTEGER"/>
        <result property="wid" column="wid" jdbcType="INTEGER"/>
        <result property="spShopid" column="sp_shopid" jdbcType="INTEGER"/>
        <result property="spName" column="sp_name" jdbcType="VARCHAR"/>
        <result property="spCompany" column="sp_Company" jdbcType="VARCHAR"/>
        <result property="spPresetPrice" column="sp_Preset_price" jdbcType="NUMERIC"/>
        <result property="number" column="number" jdbcType="INTEGER"/>
        <result property="lossNumber" column="loss_number" jdbcType="INTEGER"/>
        <result property="zje" column="zje" jdbcType="NUMERIC"/>
        <result property="spSpecifications" column="sp_Specifications" jdbcType="VARCHAR"/>
        <result property="spColor" column="sp_color" jdbcType="VARCHAR"/>
        <result property="beizhu" column="beizhu" jdbcType="VARCHAR"/>
        <result property="xsSpState" column="xs_sp_state" jdbcType="INTEGER"/>
        <result property="ysDlNumber" column="ys_dl_number" jdbcType="VARCHAR"/>
    </resultMap>
        <resultMap id="SpxstjVo" type="com.trkj.projects.vo.SpxstjVo">
        <result property="dlNumber" column="dl_number" jdbcType="VARCHAR"/>
        <result property="dlDate" column="dl_date" jdbcType="VARCHAR"/>
        <result property="dlTypeName" column="dl_type_name" jdbcType="VARCHAR"/>
        <result property="cContacts" column="c_contacts" jdbcType="VARCHAR"/>
        <result property="spShopId" column="sp_shopid" jdbcType="INTEGER"/>
        <result property="spName" column="sp_name" jdbcType="VARCHAR"/>
        <result property="spCompany" column="sp_Company" jdbcType="VARCHAR"/>
        <result property="spPresetPrice" column="sp_Preset_price" jdbcType="NUMERIC"/>
        <result property="vTypeCk" column="v_type_ck" jdbcType="NUMERIC"/>
        <result property="number" column="number" jdbcType="INTEGER"/>
        <result property="numbers" column="numbers" jdbcType="INTEGER"/>
        <result property="zsl" column="zsl" jdbcType="INTEGER"/>
            <result property="zsls" column="zsls" jdbcType="INTEGER"/>
            <result property="zje" column="zje" jdbcType="NUMERIC"/>
        <result property="zjes" column="zjes" jdbcType="NUMERIC"/>
        <result property="zjey" column="zjey" jdbcType="NUMERIC"/>
            <result property="yskh" column="yskh" jdbcType="NUMERIC"/>
            <result property="sskh" column="sskh" jdbcType="NUMERIC"/>
        <result property="agentName" column="agent_name" jdbcType="VARCHAR"/>
        <result property="wName" column="wname" jdbcType="VARCHAR"/>
        <result property="spSpecifications" column="sp_Specifications" jdbcType="VARCHAR"/>
        <result property="spTypeName" column="sp_type_name" jdbcType="VARCHAR"/>
        <result property="spColor" column="sp_color" jdbcType="VARCHAR"/>
        <result property="beiZhu" column="beizhu" jdbcType="VARCHAR"/>
        <result property="supplierName" column="suppliername" jdbcType="VARCHAR"/>
        <result property="typeName" column="type_name" jdbcType="VARCHAR"/>
        <result property="address" column="address" jdbcType="VARCHAR"/>
        <result property="spJprice" column="sp_jprice" jdbcType="NUMERIC"/>
        <result property="xslr" column="xslr" jdbcType="NUMERIC"/>
        <result property="mll" column="mll" jdbcType="NUMERIC"/>
        <result property="xswcbl" column="xswcbl" jdbcType="NUMERIC"/>
            <result property="rq" column="rq" jdbcType="VARCHAR"/>
            <result property="kcsl" column="kcsl" jdbcType="NUMERIC"/>
            <result property="kcje" column="kcje" jdbcType="NUMERIC"/>
            <result property="cgsl" column="cgsl" jdbcType="NUMERIC"/>
            <result property="cgje" column="cgje" jdbcType="NUMERIC"/>
            <result property="xssl" column="xssl" jdbcType="NUMERIC"/>
            <result property="xsje" column="xsje" jdbcType="NUMERIC"/>
            <result property="xscb" column="xscb" jdbcType="NUMERIC"/>
            <result property="yfghs" column="yfghs" jdbcType="NUMERIC"/>
            <result property="sfghs" column="sfghs" jdbcType="NUMERIC"/>
            <result property="thds" column="thds" jdbcType="INTEGER"/>
            <result property="thsl" column="thsl" jdbcType="INTEGER"/>
            <result property="thje" column="thje" jdbcType="NUMERIC"/>
            <result property="thdss" column="thdss" jdbcType="INTEGER"/>
            <result property="thsls" column="thsls" jdbcType="INTEGER"/>
            <result property="thjes" column="thjes" jdbcType="NUMERIC"/>
            <result property="bsds" column="bsds" jdbcType="INTEGER"/>
            <result property="bssl" column="bssl" jdbcType="INTEGER"/>
            <result property="bsje" column="bsje" jdbcType="NUMERIC"/>
            <result property="byds" column="byds" jdbcType="INTEGER"/>
            <result property="bysl" column="bysl" jdbcType="INTEGER"/>
            <result property="byje" column="byje" jdbcType="NUMERIC"/>
            <result property="xsds" column="xsds" jdbcType="INTEGER"/>
            <result property="cgds" column="cgds" jdbcType="INTEGER"/>
            <result property="kczl" column="kczl" jdbcType="INTEGER"/>
            <result property="xghsfkds" column="xghsfkds" jdbcType="INTEGER"/>
            <result property="xkhskds" column="xkhskds" jdbcType="INTEGER"/>
            <result property="kczj" column="kczj" jdbcType="NUMERIC"/>
    </resultMap>

    <resultMap id="DocumentShopVo" type="com.trkj.projects.vo.DocumentShopVo">
        <result property="id" column="id" jdbcType="INTEGER" />
        <result property="dlNumber" column="dl_number" jdbcType="VARCHAR"/>
        <result property="sk_number" column="sk_number" jdbcType="INTEGER"/>
        <result property="branchid" column="branchid" jdbcType="INTEGER"/>
        <result property="branchname" column="branchname" jdbcType="VARCHAR"/>
        <result property="supperlierid" column="supplierid" jdbcType="INTEGER"/>
        <result property="customerid" column="customerid" jdbcType="INTEGER"/>
        <result property="wid" column="wid" jdbcType="INTEGER"/>
        <result property="spShopid" column="sp_shopid" jdbcType="INTEGER"/>
        <result property="spShopId" column="sp_shopid" jdbcType="INTEGER"/>
        <result property="spName" column="sp_name" jdbcType="VARCHAR"/>
        <result property="spCompany" column="sp_Company" jdbcType="VARCHAR"/>
        <result property="spPresetPrice" column="sp_Preset_price" jdbcType="NUMERIC"/>
        <result property="number" column="number" jdbcType="INTEGER"/>
        <result property="numbers" column="number" jdbcType="INTEGER"/>
        <result property="lossNumber" column="loss_number" jdbcType="INTEGER"/>
        <result property="zje" column="zje" jdbcType="NUMERIC"/>
        <result property="spSpecifications" column="sp_Specifications" jdbcType="VARCHAR"/>
        <result property="spColor" column="sp_color" jdbcType="VARCHAR"/>
        <result property="beizhu" column="beizhu" jdbcType="VARCHAR"/>
        <result property="dlDate" column="dl_date" jdbcType="TIMESTAMP"/>
        <result property="xsSpState" column="xs_sp_state" jdbcType="NUMERIC"/>

    </resultMap>

    <update id="uptxsshopstate">
        update xsdocument_shop
        set xs_sp_state = 1,dl_number = #{dlNumber},ys_dl_number = #{ysDlNumber}
        <where>
            id = #{id}
        </where>
    </update>
    <!--    根据客户id查询改客户的买的商品-->
    <select id="querybycustomeridanddata" resultMap="DocumentShopVo">
        SELECT s.id,s.dl_number ,s.customerid,s.branchid,b.branchname,s.wid,s.sp_shopid,s.sp_name,s.sp_Company,s.sp_Preset_price,s.number,s.loss_number,k.sk_number,s.zje,s.sp_Specifications,s.sp_color,s.beizhu,xs.dl_date,s.xs_sp_state
        FROM xsdocument_shop s
        LEFT JOIN xsdocument_list xs ON s.dl_number=xs.dl_number
        LEFT JOIN branch b ON s.branchid=b.branchid
        LEFT JOIN stock k ON s.sp_shopid=k.sk_shopid
        <where>
            s.customerid = #{customerid}
            <if test="data1 != null and data1 != '' and data2 != null and data2 != ''">
                and DATE_FORMAT(xs.dl_date,'%Y-%m-%d') BETWEEN DATE_FORMAT(#{data1},'%Y-%m-%d') and DATE_FORMAT(#{data2},'%Y-%m-%d')
            </if>
            <if test="name != null and name != ''">
                and s.sp_shopid = #{name}
                or s.sp_name like CONCAT('%',#{name},'%')
            </if>
        </where>
        ORDER BY xs.dl_date DESC
    </select>
    <!-- 根据商品单据号删除商品 -->
    <delete id="deleteshoplist" >
        delete from projects.xsdocument_shop where dl_number = #{number}
    </delete>
    <!-- 通过单据号查询商品 -->
    <select id="selectnumber" resultMap="DocumentShopVo">
        SELECT dsp.id,dm.branchid,ws.wid,dsp.dl_number,dsp.sp_shopid,dsp.sp_name,dsp.sp_Company,dsp.sp_Preset_price,sk.sk_number,dsp.number,dsp.loss_number,dsp.zje,dsp.sp_Specifications,dsp.sp_color,dsp.beizhu,dsp.customerid
        FROM xsdocument_shop dsp
        LEFT JOIN warehouse ws ON dsp.wid = ws.wid
        LEFT JOIN stock sk ON sk.sk_shopid = dsp.sp_shopid
        LEFT JOIN `branch` dm ON dm.branchid = ws.branchid
        WHERE dsp.dl_number =  #{param1} and dsp.wid = #{param2}
    </select>
    <!--查询单个-->
    <select id="queryById" resultMap="XsdocumentShopMap">
        select
          id, dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company, sp_Preset_price, number, loss_number, zje, sp_Specifications, sp_color, beizhu, xs_sp_state
        from projects.xsdocument_shop
        where id = #{id}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="XsdocumentShopMap">
        select
          id, dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company, sp_Preset_price, number, loss_number, zje, sp_Specifications, sp_color, beizhu, xs_sp_state
        from projects.xsdocument_shop
        limit #{offset}, #{limit}
    </select>

    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="XsdocumentShopMap">
        select
        id, dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company, sp_Preset_price, number, loss_number,
        zje, sp_Specifications, sp_color, beizhu, xs_sp_state
        from projects.xsdocument_shop
        <where>
            <if test="id != null">
                and id = #{id}
            </if>
            <if test="dlNumber != null and dlNumber != ''">
                and dl_number = #{dlNumber}
            </if>
            <if test="branchid != null">
                and branchid = #{branchid}
            </if>
            <if test="customerid != null">
                and customerid = #{customerid}
            </if>
            <if test="wid != null">
                and wid = #{wid}
            </if>
            <if test="spShopid != null">
                and sp_shopid = #{spShopid}
            </if>
            <if test="spName != null and spName != ''">
                and sp_name = #{spName}
            </if>
            <if test="spCompany != null and spCompany != ''">
                and sp_Company = #{spCompany}
            </if>
            <if test="spPresetPrice != null">
                and sp_Preset_price = #{spPresetPrice}
            </if>
            <if test="number != null">
                and number = #{number}
            </if>
            <if test="lossNumber != null">
                and loss_number = #{lossNumber}
            </if>
            <if test="zje != null">
                and zje = #{zje}
            </if>
            <if test="spSpecifications != null and spSpecifications != ''">
                and sp_Specifications = #{spSpecifications}
            </if>
            <if test="spColor != null and spColor != ''">
                and sp_color = #{spColor}
            </if>
            <if test="beizhu != null and beizhu != ''">
                and beizhu = #{beizhu}
            </if>
            <if test="xsSpState != null">
                and xs_sp_state = #{xsSpState}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="id" useGeneratedKeys="true">
        insert into projects.xsdocument_shop(dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company, sp_Preset_price, number, loss_number, zje, sp_Specifications, sp_color, beizhu, xs_sp_state)
        values (#{dlNumber}, #{branchid}, #{customerid}, #{wid}, #{spShopid}, #{spName}, #{spCompany}, #{spPresetPrice}, #{number}, #{lossNumber}, #{zje}, #{spSpecifications}, #{spColor}, #{beizhu}, #{xsSpState})
    </insert>

    <insert id="insertBatch" keyProperty="id" useGeneratedKeys="true">
        insert into projects.xsdocument_shop(dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company,
        sp_Preset_price, number, loss_number, zje, sp_Specifications, sp_color, beizhu, xs_sp_state)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.dlNumber}, #{entity.branchid}, #{entity.customerid}, #{entity.wid}, #{entity.spShopid},
            #{entity.spName}, #{entity.spCompany}, #{entity.spPresetPrice}, #{entity.number}, #{entity.lossNumber},
            #{entity.zje}, #{entity.spSpecifications}, #{entity.spColor}, #{entity.beizhu}, #{entity.xsSpState})
        </foreach>
    </insert>

    <insert id="insertOrUpdateBatch" keyProperty="id" useGeneratedKeys="true">
        insert into projects.xsdocument_shop(dl_number, branchid, customerid, wid, sp_shopid, sp_name, sp_Company,
        sp_Preset_price, number, loss_number, zje, sp_Specifications, sp_color, beizhu, xs_sp_state)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.dlNumber}, #{entity.branchid}, #{entity.customerid}, #{entity.wid}, #{entity.spShopid},
            #{entity.spName}, #{entity.spCompany}, #{entity.spPresetPrice}, #{entity.number}, #{entity.lossNumber},
            #{entity.zje}, #{entity.spSpecifications}, #{entity.spColor}, #{entity.beizhu}, #{entity.xsSpState})
        </foreach>
        on duplicate key update
        dl_number = values(dl_number) , branchid = values(branchid) , customerid = values(customerid) , wid =
        values(wid) , sp_shopid = values(sp_shopid) , sp_name = values(sp_name) , sp_Company = values(sp_Company) ,
        sp_Preset_price = values(sp_Preset_price) , number = values(number) , loss_number = values(loss_number) , zje =
        values(zje) , sp_Specifications = values(sp_Specifications) , sp_color = values(sp_color) , beizhu =
        values(beizhu) , xs_sp_state = values(xs_sp_state)
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update projects.xsdocument_shop
        <set>
            <if test="dlNumber != null and dlNumber != ''">
                dl_number = #{dlNumber},
            </if>
            <if test="branchid != null">
                branchid = #{branchid},
            </if>
            <if test="customerid != null">
                customerid = #{customerid},
            </if>
            <if test="wid != null">
                wid = #{wid},
            </if>
            <if test="spShopid != null">
                sp_shopid = #{spShopid},
            </if>
            <if test="spName != null and spName != ''">
                sp_name = #{spName},
            </if>
            <if test="spCompany != null and spCompany != ''">
                sp_Company = #{spCompany},
            </if>
            <if test="spPresetPrice != null">
                sp_Preset_price = #{spPresetPrice},
            </if>
            <if test="number != null">
                number = #{number},
            </if>
            <if test="lossNumber != null">
                loss_number = #{lossNumber},
            </if>
            <if test="zje != null">
                zje = #{zje},
            </if>
            <if test="spSpecifications != null and spSpecifications != ''">
                sp_Specifications = #{spSpecifications},
            </if>
            <if test="spColor != null and spColor != ''">
                sp_color = #{spColor},
            </if>
            <if test="beizhu != null and beizhu != ''">
                beizhu = #{beizhu},
            </if>
            <if test="xsSpState != null">
                xs_sp_state = #{xsSpState},
            </if>
            <if test="ysDlNumber != null and ysDlNumber != ''">
                ys_dl_number = #{ysDlNumber},
            </if>
        </set>
        where id = #{id}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from projects.xsdocument_shop where id = #{id}
    </delete>
    <select id="xsspmx" resultMap="SpxstjVo">
        SELECT l.dl_number,l.dl_date,lt.dl_type_name,c.c_contacts,s.sp_shopid,s.sp_name,s.sp_Company,s.sp_Preset_price,
        v.v_type_ck,s.number,s.zje,a.agent_name,w.wname,s.sp_Specifications,s.sp_color,st.sp_type_name,s.beizhu,
        s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,dsp.zje AS zjes
        FROM xsdocument_shop s
        INNER JOIN xsdocument_list l ON s.dl_number=l.dl_number
        INNER JOIN xsdocument_list_type lt ON l.dl_type_id=lt.dl_type_id
        INNER JOIN customer c ON l.customerid=c.c_id
        INNER JOIN shop sp ON s.sp_shopid=sp.sp_shopid
        INNER JOIN vip_type v ON c.v_type_id=v.v_type_id
        INNER JOIN agent a ON l.agent_id=a.id
        INNER JOIN warehouse w ON w.wid=s.wid
        INNER JOIN shop_type st ON sp.sp_type_id=st.sp_type_id
        INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
        GROUP BY dl_number,dl_type_name,c_contacts,sp_shopid,sp_Company,sp_Preset_price,v_type_ck,zje,agent_name,
    sp_Specifications,sp_color
    </select>
    <select id="khtj" resultMap="SpxstjVo">
           SELECT c.c_contacts,tc.type_name,a.address,SUM(s.number) AS number,SUM(s.zje) AS zje,s.zje-sp.zje AS xslr,(sp_Preset_price-sp_jprice)/sp_Preset_price AS mll
           FROM `customer` c
           LEFT JOIN `customer_type` tc ON c.c_typeid=tc.typeid
           LEFT JOIN `address` a ON a.addressid=c.addressid
           LEFT JOIN `xsdocument_shop` s ON s.customerid=c.c_id
           LEFT JOIN `document_shop` sp ON  sp.sp_shopid=s.sp_shopid
	GROUP BY c_contacts,type_name,address
    </select>
    <select id="xssphz" resultMap="SpxstjVo">
        SELECT sp.sp_shopid,sp.sp_name,sp.sp_Company,
     SUM(s.number) AS number,SUM(s.zje) AS zje,s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,
     dsp.zje AS zjes
        FROM xsdocument_shop s
        LEFT JOIN xsdocument_list l ON s.dl_number=l.dl_number
        LEFT JOIN customer c ON l.customerid=c.c_id
        LEFT JOIN shop sp ON s.sp_shopid=sp.sp_shopid
        LEFT JOIN shop_type st ON sp.sp_type_id=st.sp_type_id
        INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
        GROUP BY sp_shopid,sp_name,sp_Company
    </select>
    <select id="selectnumber3xyz" resultMap="SpxstjVo">
        SELECT s.dl_number,l.dl_date,c.c_contacts,s.sp_shopid,s.sp_name,s.sp_Company,s.sp_Preset_price,
        s.number,s.zje,s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,
        s.sp_Specifications,s.sp_color,w.wname,a.agent_name
         FROM xsdocument_shop s
         INNER JOIN `xsdocument_list` l ON l.dl_number=s.dl_number
         INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
         INNER JOIN `warehouse` w ON w.wid=s.wid
         INNER JOIN agent a ON l.agent_id=a.id
         INNER JOIN `customer` c ON s.customerid=c.c_typeid
         INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
         WHERE c.c_contacts = #{param1} AND dls.dl_statie_id =2
         GROUP BY dl_number,sp_shopid,sp_name,sp_Preset_price,sp_Company,sp_Specifications,sp_color,wname,agent_name,c_contacts
    </select>
    <select id="selectnumber4xyz" resultMap="SpxstjVo">
         SELECT s.dl_number,l.dl_date,c.c_contacts,s.sp_shopid,s.sp_name,s.sp_Company,s.sp_Preset_price,
         s.number,s.zje,s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,
         s.sp_Specifications,s.sp_color,w.wname,a.agent_name
         FROM xsdocument_shop s
         INNER JOIN `xsdocument_list` l ON l.dl_number=s.dl_number
         INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
         INNER JOIN document_list dl ON dl.dl_number=dsp.dl_number
         INNER JOIN `warehouse` w ON w.wid=s.wid
         INNER JOIN agent a ON l.agent_id=a.id
         INNER JOIN `customer` c ON s.customerid=c.c_typeid
         INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
         INNER JOIN `supplier` sup ON dl.supplierid=sup.supplierid
         WHERE sup.suppliername = #{param1} AND dls.dl_statie_id =2
         GROUP BY dl_number,sp_shopid,sp_name,sp_Preset_price,sp_Company,sp_Specifications,sp_color,wname,agent_name,c_contacts
    </select>
    <select id="xsspfltj" resultMap="SpxstjVo">
      SELECT st.sp_type_name,SUM(s.number) AS number,SUM(s.zje) AS zje,s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,
     dsp.zje AS zjes
        FROM xsdocument_shop s
        LEFT JOIN shop sp ON s.sp_shopid=sp.sp_shopid
        LEFT JOIN shop_type st ON sp.sp_type_id=st.sp_type_id
        LEFT JOIN document_shop ds ON ds.dl_number=s.dl_number
        INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
        GROUP BY sp_type_name
    </select>
    <select id="ghstj" resultMap="SpxstjVo">
     SELECT sup.suppliername,SUM(s.number) AS number,SUM(s.zje) AS zje,SUM(sp.number) AS numbers,
     SUM(sp.zje) AS zjes,(SUM(sp.number))/(SUM(s.number)) AS xswcbl,s.zje-sp.zje AS xslr,(s.sp_Preset_price-sp.sp_jprice)/s.sp_Preset_price AS mll
     FROM xsdocument_shop s
     INNER JOIN xsdocument_list l ON l.dl_number=s.dl_number
     INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
     INNER JOIN `document_shop` sp ON  sp.sp_shopid=s.sp_shopid
     INNER JOIN document_list dl ON dl.dl_number=sp.dl_number
     INNER JOIN document_list_static dlsc ON  dlsc.dl_statie_id=dl.dl_statie_id
     INNER JOIN `supplier` sup ON dl.supplierid=sup.supplierid
     WHERE  dls.dl_statie_id =2 AND dlsc.dl_statie_id = 0
     GROUP BY suppliername
    </select>
    <select id="artj" resultMap="SpxstjVo">
     SELECT l.dl_date,SUM(s.number) AS number,SUM(s.zje) AS zje,SUM(sp.number) AS numbers,SUM(sp.zje) AS zjes,s.zje-sp.zje AS zjey,s.zje-sp.zje AS xslr,(s.sp_Preset_price-sp.sp_jprice)/s.sp_Preset_price AS mll
     FROM xsdocument_shop s
     INNER JOIN xsdocument_list l ON l.dl_number=s.dl_number
     INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
     INNER JOIN `document_shop` sp ON  sp.sp_shopid=s.sp_shopid
     INNER JOIN document_list dl ON dl.dl_number=sp.dl_number
     INNER JOIN document_list_static dlsc ON  dlsc.dl_statie_id=dl.dl_statie_id
     INNER JOIN `supplier` sup ON dl.supplierid=sup.supplierid
     WHERE  dls.dl_statie_id =2 AND dlsc.dl_statie_id = 0
     GROUP BY dl_date
    </select>
    <select id="aytj" resultMap="SpxstjVo">
     SELECT DATE_FORMAT( l.dl_date, '%Y-%m' ) AS rq,SUM(sk.sk_number) AS kcsl,(SUM(sk.sk_number))*sp.sp_jprice AS kcje,
	SUM(sp.number) AS cgsl,SUM(sp.zje)AS cgje,SUM(s.number) AS xssl,SUM(l.dl_ssje) AS xsje,s.zje,sp.sp_jprice*s.number AS xscb,s.zje-sp.zje AS xslr,
	(s.sp_Preset_price-sp.sp_jprice)/s.sp_Preset_price AS mll
	FROM xsdocument_list l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN `stock` sk ON sk.sk_shopid=s.sp_shopid
         INNER JOIN `document_shop` sp ON sp.sp_shopid=s.sp_shopid
         INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	WHERE YEAR(dl_date) = 2021 AND dls.dl_statie_id =2
	 GROUP BY MONTH(dl_date);
    </select>
    <select id="ckcx" resultMap="SpxstjVo">
         SELECT wname
            FROM warehouse
    </select>
    <select id="lbcx" resultMap="SpxstjVo">
         SELECT sp_type_name
            FROM shop_type
    </select>
    <select id="xsmxcx" resultMap="SpxstjVo">
        SELECT l.dl_number,l.dl_date,lt.dl_type_name,c.c_contacts,s.sp_shopid,s.sp_name,s.sp_Company,s.sp_Preset_price,
        v.v_type_ck,s.number,s.zje,a.agent_name,w.wname,s.sp_Specifications,s.sp_color,st.sp_type_name,s.beizhu,
        s.zje-dsp.zje AS xslr,(s.sp_Preset_price-dsp.sp_jprice)/s.sp_Preset_price AS mll,dsp.zje AS zjes
        FROM xsdocument_shop s
        INNER JOIN xsdocument_list l ON s.dl_number=l.dl_number
        INNER JOIN xsdocument_list_type lt ON l.dl_type_id=lt.dl_type_id
        INNER JOIN customer c ON l.customerid=c.c_id
        INNER JOIN shop sp ON s.sp_shopid=sp.sp_shopid
        INNER JOIN vip_type v ON c.v_type_id=v.v_type_id
        INNER JOIN agent a ON l.agent_id=a.id
        INNER JOIN warehouse w ON w.wid=s.wid
        INNER JOIN shop_type st ON sp.sp_type_id=st.sp_type_id
        INNER JOIN `document_shop` dsp ON  dsp.sp_shopid=s.sp_shopid
        <where>
            <if test="spName != null">
                sp.sp_name LIKE CONCAT('%',#{spName},'%')
            </if>
            <if test="spTypeName != null">
                and st.sp_type_name = #{spTypeName}
            </if>
            <if test="WName != null">
                and w.wname = #{WName}
            </if>
        </where>
        GROUP BY dl_number,dl_type_name,c_contacts,sp_shopid,sp_Company,sp_Preset_price,v_type_ck,zje,agent_name,
        sp_Specifications,sp_color
    </select>

    <select id="cgqk1" resultMap="SpxstjVo">
     SELECT COUNT(l.id) AS thds,SUM(s.number) AS thsl,SUM(zje) AS thje
	 FROM `document_list` l
	 INNER JOIN `document_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2
    </select>
    <select id="cgqk2" resultMap="SpxstjVo">
      SELECT COUNT(l.id) AS cgds,SUM(s.number) AS cgsl,SUM(zje) AS cgje
	 FROM `document_list` l
	 INNER JOIN `document_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =0
    </select>
    <select id="cgqk3" resultMap="SpxstjVo">
     SELECT SUM(s.number) AS zsl,SUM(zje) AS zje
	 FROM `document_list` l
	 INNER JOIN `document_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =0 OR dls.dl_statie_id =2
    </select>
    <select id="xsqk1" resultMap="SpxstjVo">
     SELECT COUNT(l.id) AS thdss,SUM(s.number) AS thsls,SUM(zje) AS thjes
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =1
    </select>
    <select id="xsqk2" resultMap="SpxstjVo">
      SELECT COUNT(l.id) AS xsds,SUM(s.number) AS xssl,SUM(zje) AS xsje
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2
    </select>
    <select id="xsqk3" resultMap="SpxstjVo">
     SELECT SUM(s.number) AS zsls,SUM(zje) AS zjes
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2
    </select>
    <select id="bsbyqk" resultMap="SpxstjVo">
     SELECT COUNT(bs.id) AS bsds,SUM(bs.bs_numbers) AS bssl,SUM(bs.zje) AS bsje
	 FROM `bs_by_shop` bs
	 INNER JOIN `bs_report` br ON  br.bs_Loss_report=bs.bs_Loss_report
	 INNER JOIN `bs_by_type` bt ON bt.Documents_type_id=br.Documents_type_id
	 WHERE bt.Documents_type_id =1
    </select>
    <select id="bsbyqk1" resultMap="SpxstjVo">
     SELECT COUNT(bs.id) AS byds,SUM(bs.bs_numbers) AS bysl,SUM(bs.zje) AS byje
	 FROM `bs_by_shop` bs
	 INNER JOIN `bs_report` br ON  br.bs_Loss_report=bs.bs_Loss_report
	 INNER JOIN `bs_by_type` bt ON bt.Documents_type_id=br.Documents_type_id
	 WHERE bt.Documents_type_id =2
    </select>
    <select id="kcqk" resultMap="SpxstjVo">
     SELECT SUM(kc.sk_number) AS kczl,(SUM(kc.sk_number))*sp_jprice AS kczj
	 FROM `stock` kc
	 INNER JOIN `document_shop` s ON kc.sk_shopid=s.sp_shopid
	 INNER JOIN `document_list` l ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =0
    </select>
    <select id="fkshqk" resultMap="SpxstjVo">
     SELECT COUNT(l.id) AS xghsfkds
	 FROM `document_list` l
	 INNER JOIN `document_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =0 OR dls.dl_statie_id =2
    </select>
    <select id="fkshqk1" resultMap="SpxstjVo">
     SELECT COUNT(l.id) AS xkhskds
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2
    </select>
    <select id="fkshqk2" resultMap="SpxstjVo">
     SELECT SUM(l.dl_yfje) AS yfghs,SUM(l.dl_sfje)AS sfghs
	 FROM `document_list` l
	 INNER JOIN `document_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN document_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =0
    </select>
    <select id="fkshqk3" resultMap="SpxstjVo">
     SELECT SUM(l.dl_ysje) AS yskh,SUM(l.dl_ssje)AS sskh
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2
    </select>
    <select id="cwfx" resultMap="SpxstjVo">
     SELECT SUM(sp.sp_jprice) AS xscb,SUM(s.sp_Preset_price-sp.sp_jprice)AS xslr,(s.sp_Preset_price-sp.sp_jprice)/s.sp_Preset_price AS mll
	 FROM `xsdocument_list` l
	 INNER JOIN `xsdocument_shop` s ON s.dl_number=l.dl_number
	 INNER JOIN `document_shop` sp ON s.sp_shopid=sp.sp_shopid
	 INNER JOIN document_list_static dlsc ON  dlsc.dl_statie_id=l.dl_statie_id
	 INNER JOIN xsdocument_list_static dls ON  dls.dl_statie_id=l.dl_statie_id
	 WHERE dls.dl_statie_id =2 OR dlsc.dl_statie_id =0
    </select>
</mapper>

